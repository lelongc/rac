<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Web Builder</title>
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/builder.css" />
  </head>
  <body>
    <div class="container-fluid">
      <header class="bg-primary text-white p-3 mb-4">
        <h1 class="text-center">Web Builder</h1>
        <p class="text-center">Tạo trang web form và table tùy chỉnh</p>
      </header>

      <!-- Template Selection Section -->
      <div class="row mb-4">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header bg-info text-white">
              <h5>Chọn mẫu giao diện</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <!-- Example 1: English Course Registration -->
                <div class="col-md-4">
                  <div class="template-card" data-template="english-course">
                    <div class="card">
                      <img
                        src="img/template1.png"
                        class="card-img-top"
                        alt="English Course Registration Template"
                      />
                      <div class="card-body">
                        <h5 class="card-title">Đăng ký khóa học tiếng Anh</h5>
                        <p class="card-text">
                          Form đăng ký khóa học với các trường: họ tên, SĐT,
                          email, ngày sinh...
                        </p>
                        <button
                          class="btn btn-primary w-100 select-template"
                          data-template="english-course"
                        >
                          Chọn mẫu này
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Example 2: Flower Shop Order Form -->
                <div class="col-md-4">
                  <div class="template-card" data-template="flower-order">
                    <div class="card">
                      <img
                        src="img/template2.png"
                        class="card-img-top"
                        alt="Flower Order Template"
                      />
                      <div class="card-body">
                        <h5 class="card-title">Đặt mua hoa</h5>
                        <p class="card-text">
                          Form đặt hàng với họ tên, SĐT, ngày đặt, email, ảnh
                          đại diện...
                        </p>
                        <button
                          class="btn btn-primary w-100 select-template"
                          data-template="flower-order"
                        >
                          Chọn mẫu này
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Example 3: Course Registration -->
                <div class="col-md-4">
                  <div
                    class="template-card"
                    data-template="course-registration"
                  >
                    <div class="card">
                      <img
                        src="img/template3.png"
                        class="card-img-top"
                        alt="Course Registration Template"
                      />
                      <div class="card-body">
                        <h5 class="card-title">Đăng ký học viên</h5>
                        <p class="card-text">
                          Form đăng ký học viên với họ tên, SĐT, email, địa chỉ,
                          ngày sinh...
                        </p>
                        <button
                          class="btn btn-primary w-100 select-template"
                          data-template="course-registration"
                        >
                          Chọn mẫu này
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Start from scratch option -->
              <div class="row mt-3">
                <div class="col-md-12">
                  <button
                    class="btn btn-outline-secondary w-100"
                    id="startFromScratch"
                  >
                    Tạo mới từ đầu
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row" id="builder-interface" style="display: none">
        <!-- Left sidebar - Configuration Options -->
        <div class="col-md-3">
          <div class="card">
            <div class="card-header bg-secondary text-white">
              <h5>Tùy chỉnh giao diện</h5>
            </div>
            <div class="card-body">
              <form id="configForm">
                <!-- Website Title -->
                <div class="mb-3">
                  <label for="websiteTitle" class="form-label"
                    >Tiêu đề trang web</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="websiteTitle"
                    value="Website Builder"
                  />
                </div>

                <!-- Header Settings -->
                <div class="mb-3">
                  <h6>Header</h6>
                  <div class="input-group mb-2">
                    <span class="input-group-text">Màu nền</span>
                    <input
                      type="color"
                      class="form-control form-control-color"
                      id="headerBgColor"
                      value="#0d6efd"
                    />
                  </div>
                  <div class="input-group mb-2">
                    <span class="input-group-text">Màu chữ</span>
                    <input
                      type="color"
                      class="form-control form-control-color"
                      id="headerTextColor"
                      value="#ffffff"
                    />
                  </div>
                </div>

                <!-- Form Settings -->
                <div class="mb-3">
                  <h6>Form</h6>
                  <div class="input-group mb-2">
                    <span class="input-group-text">Màu nền</span>
                    <input
                      type="color"
                      class="form-control form-control-color"
                      id="formBgColor"
                      value="#ffffff"
                    />
                  </div>
                  <div class="input-group mb-2">
                    <span class="input-group-text">Màu viền</span>
                    <input
                      type="color"
                      class="form-control form-control-color"
                      id="formBorderColor"
                      value="#000000"
                    />
                  </div>
                </div>

                <!-- Footer Settings -->
                <div class="mb-3">
                  <h6>Footer</h6>
                  <div class="input-group mb-2">
                    <span class="input-group-text">Màu nền</span>
                    <input
                      type="color"
                      class="form-control form-control-color"
                      id="footerBgColor"
                      value="#0d6efd"
                    />
                  </div>
                  <div class="input-group mb-2">
                    <span class="input-group-text">Màu chữ</span>
                    <input
                      type="color"
                      class="form-control form-control-color"
                      id="footerTextColor"
                      value="#ffffff"
                    />
                  </div>
                </div>

                <!-- Footer Text -->
                <div class="mb-3">
                  <label for="footerText" class="form-label"
                    >Nội dung footer</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="footerText"
                    value="MSSV: 23630851 | Họ tên: Lê Thành Long"
                  />
                </div>

                <!-- Button to apply changes -->
                <button
                  type="button"
                  class="btn btn-primary w-100"
                  id="applyChanges"
                >
                  Áp dụng thay đổi
                </button>
              </form>
            </div>
          </div>

          <!-- Form Field Creator -->
          <div class="card mt-3">
            <div class="card-header bg-secondary text-white">
              <h5>Tạo trường nhập liệu</h5>
            </div>
            <div class="card-body">
              <form id="fieldCreatorForm">
                <div class="mb-3">
                  <label for="fieldType" class="form-label">Loại trường</label>
                  <select class="form-select" id="fieldType">
                    <option value="text">Text</option>
                    <option value="email">Email</option>
                    <option value="tel">Điện thoại</option>
                    <option value="date">Ngày tháng</option>
                    <option value="radio">Radio buttons</option>
                    <option value="checkbox">Checkbox</option>
                  </select>
                </div>

                <div class="mb-3">
                  <label for="fieldLabel" class="form-label">Nhãn trường</label>
                  <input
                    type="text"
                    class="form-control"
                    id="fieldLabel"
                    placeholder="Nhập nhãn"
                  />
                </div>

                <div class="mb-3">
                  <label for="fieldName" class="form-label">ID trường</label>
                  <input
                    type="text"
                    class="form-control"
                    id="fieldName"
                    placeholder="ID trường"
                  />
                </div>

                <div class="mb-3">
                  <label for="fieldPlaceholder" class="form-label"
                    >Placeholder</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="fieldPlaceholder"
                    placeholder="Placeholder text"
                  />
                </div>

                <div class="mb-3">
                  <label for="validationRegex" class="form-label"
                    >Biểu thức regex kiểm tra</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="validationRegex"
                    placeholder="Regex pattern"
                  />
                </div>

                <div class="mb-3">
                  <label for="errorMessage" class="form-label"
                    >Thông báo lỗi</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="errorMessage"
                    placeholder="Thông báo khi nhập sai"
                  />
                </div>

                <div class="mb-3 form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    id="requiredField"
                  />
                  <label class="form-check-label" for="requiredField"
                    >Bắt buộc</label
                  >
                </div>

                <div id="optionsContainer" class="mb-3 d-none">
                  <label class="form-label"
                    >Tùy chọn (cho radio/checkbox)</label
                  >
                  <div class="input-group mb-2">
                    <input
                      type="text"
                      class="form-control"
                      placeholder="Giá trị"
                    />
                    <input
                      type="text"
                      class="form-control"
                      placeholder="Nhãn hiển thị"
                    />
                    <button type="button" class="btn btn-outline-secondary">
                      +
                    </button>
                  </div>
                  <div id="optionsList"></div>
                </div>

                <button
                  type="button"
                  class="btn btn-primary w-100"
                  id="addField"
                >
                  Thêm trường
                </button>
              </form>
            </div>
          </div>

          <div class="card mt-3">
            <div class="card-header bg-secondary text-white">
              <h5>Tùy chọn xuất</h5>
            </div>
            <div class="card-body">
              <button
                type="button"
                class="btn btn-success w-100 mb-2"
                id="previewWebsite"
              >
                Xem trước
              </button>
              <button
                type="button"
                class="btn btn-danger w-100"
                id="generateCode"
              >
                Tạo mã
              </button>
            </div>
          </div>
        </div>

        <!-- Main content area - Form Builder -->
        <div class="col-md-9">
          <div class="card">
            <div
              class="card-header bg-info text-white d-flex justify-content-between align-items-center"
            >
              <h5>Thiết kế form</h5>
              <div>
                <button class="btn btn-light btn-sm" id="moveFieldUp">↑</button>
                <button class="btn btn-light btn-sm" id="moveFieldDown">
                  ↓
                </button>
                <button class="btn btn-warning btn-sm" id="editField">
                  Sửa trường
                </button>
                <button class="btn btn-danger btn-sm" id="removeField">
                  Xóa trường
                </button>
              </div>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6">
                  <h6>Form đăng ký</h6>
                  <div id="formBuilder" class="border p-3 min-height-300">
                    <!-- Form fields will be added here -->
                  </div>
                  <button class="btn btn-primary mt-2" id="addSubmitButton">
                    Thêm nút Submit
                  </button>
                </div>
                <div class="col-md-6">
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <h6>Bảng hiển thị</h6>
                    <div>
                      <button
                        class="btn btn-success btn-sm"
                        id="addTableColumn"
                      >
                        Thêm cột
                      </button>
                      <button
                        class="btn btn-danger btn-sm"
                        id="removeTableColumn"
                      >
                        Xóa cột
                      </button>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table class="table table-bordered" id="previewTable">
                      <thead>
                        <tr id="tableHeader">
                          <th>STT</th>
                          <!-- Table headers will be added here -->
                        </tr>
                      </thead>
                      <tbody>
                        <!-- Table content will be added here -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Code Preview -->
          <div class="card mt-3">
            <div class="card-header bg-dark text-white">
              <h5>Preview mã</h5>
            </div>
            <div class="card-body">
              <ul class="nav nav-tabs" id="codeTabs" role="tablist">
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link active"
                    id="html-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#html"
                    type="button"
                    role="tab"
                  >
                    HTML
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link"
                    id="css-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#css"
                    type="button"
                    role="tab"
                  >
                    CSS
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button
                    class="nav-link"
                    id="js-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#js"
                    type="button"
                    role="tab"
                  >
                    JavaScript
                  </button>
                </li>
              </ul>
              <div class="tab-content p-2" id="codeContent">
                <div
                  class="tab-pane fade show active"
                  id="html"
                  role="tabpanel"
                >
                  <pre
                    id="htmlCode"
                    class="bg-light p-2"
                    style="max-height: 300px; overflow-y: auto"
                  ></pre>
                </div>
                <div class="tab-pane fade" id="css" role="tabpanel">
                  <pre
                    id="cssCode"
                    class="bg-light p-2"
                    style="max-height: 300px; overflow-y: auto"
                  ></pre>
                </div>
                <div class="tab-pane fade" id="js" role="tabpanel">
                  <pre
                    id="jsCode"
                    class="bg-light p-2"
                    style="max-height: 300px; overflow-y: auto"
                  ></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Preview Modal -->
    <div
      class="modal fade"
      id="previewModal"
      tabindex="-1"
      aria-labelledby="previewModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="previewModalLabel">
              Xem trước trang web
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <iframe
              id="previewFrame"
              style="width: 100%; height: 600px; border: none"
            ></iframe>
          </div>
        </div>
      </div>
    </div>

    <!-- Export Code Modal -->
    <div
      class="modal fade"
      id="exportModal"
      tabindex="-1"
      aria-labelledby="exportModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exportModalLabel">Mã nguồn</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <ul class="nav nav-tabs" id="exportTabs" role="tablist">
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link active"
                  id="export-html-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#export-html"
                  type="button"
                  role="tab"
                >
                  index.html
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="export-css-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#export-css"
                  type="button"
                  role="tab"
                >
                  style.css
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="export-js-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#export-js"
                  type="button"
                  role="tab"
                >
                  script.js
                </button>
              </li>
            </ul>
            <div class="tab-content p-2" id="exportContent">
              <div
                class="tab-pane fade show active"
                id="export-html"
                role="tabpanel"
              >
                <pre
                  id="exportHtmlCode"
                  class="bg-light p-2"
                  style="max-height: 400px; overflow-y: auto"
                ></pre>
              </div>
              <div class="tab-pane fade" id="export-css" role="tabpanel">
                <pre
                  id="exportCssCode"
                  class="bg-light p-2"
                  style="max-height: 400px; overflow-y: auto"
                ></pre>
              </div>
              <div class="tab-pane fade" id="export-js" role="tabpanel">
                <pre
                  id="exportJsCode"
                  class="bg-light p-2"
                  style="max-height: 400px; overflow-y: auto"
                ></pre>
              </div>
            </div>
            <div class="d-grid gap-2 mt-3">
              <button type="button" class="btn btn-success" id="downloadZip">
                Tải xuống tất cả (ZIP)
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Field Modal -->
    <div
      class="modal fade"
      id="editFieldModal"
      tabindex="-1"
      aria-labelledby="editFieldModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="editFieldModalLabel">Sửa trường</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="editFieldForm">
              <div class="mb-3">
                <label for="editFieldLabel" class="form-label"
                  >Nhãn trường</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="editFieldLabel"
                  required
                />
              </div>

              <div class="mb-3">
                <label for="editFieldName" class="form-label">ID trường</label>
                <input
                  type="text"
                  class="form-control"
                  id="editFieldName"
                  required
                />
              </div>

              <div class="mb-3">
                <label for="editFieldPlaceholder" class="form-label"
                  >Placeholder</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="editFieldPlaceholder"
                />
              </div>

              <div class="mb-3">
                <label for="editValidationRegex" class="form-label"
                  >Biểu thức regex kiểm tra</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="editValidationRegex"
                />
              </div>

              <div class="mb-3">
                <label for="editErrorMessage" class="form-label"
                  >Thông báo lỗi</label
                >
                <input type="text" class="form-control" id="editErrorMessage" />
              </div>

              <div class="mb-3 form-check">
                <input
                  type="checkbox"
                  class="form-check-input"
                  id="editRequiredField"
                />
                <label class="form-check-label" for="editRequiredField"
                  >Bắt buộc</label
                >
              </div>

              <div id="editOptionsContainer" class="mb-3 d-none">
                <label class="form-label">Tùy chọn</label>
                <div class="input-group mb-2">
                  <input
                    type="text"
                    class="form-control"
                    id="editOptionValue"
                    placeholder="Giá trị"
                  />
                  <input
                    type="text"
                    class="form-control"
                    id="editOptionLabel"
                    placeholder="Nhãn hiển thị"
                  />
                  <button
                    type="button"
                    class="btn btn-outline-secondary"
                    id="addEditOption"
                  >
                    +
                  </button>
                </div>
                <div id="editOptionsList"></div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Đóng
            </button>
            <button type="button" class="btn btn-primary" id="saveFieldChanges">
              Lưu thay đổi
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Table Column Modal -->
    <div
      class="modal fade"
      id="addColumnModal"
      tabindex="-1"
      aria-labelledby="addColumnModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addColumnModalLabel">Thêm cột mới</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="addColumnForm">
              <div class="mb-3">
                <label for="columnTitle" class="form-label">Tiêu đề cột</label>
                <input
                  type="text"
                  class="form-control"
                  id="columnTitle"
                  required
                />
              </div>

              <div class="mb-3">
                <label for="columnDataSource" class="form-label"
                  >Nguồn dữ liệu</label
                >
                <select class="form-select" id="columnDataSource">
                  <option value="none">-- Chọn trường --</option>
                  <!-- Form fields will be added here -->
                </select>
              </div>

              <div class="mb-3">
                <label for="columnCustomFormat" class="form-label"
                  >Định dạng hiển thị (tùy chọn)</label
                >
                <select class="form-select" id="columnCustomFormat">
                  <option value="none">Không định dạng</option>
                  <option value="date">Định dạng ngày (DD/MM/YYYY)</option>
                  <option value="list">Dạng danh sách</option>
                  <option value="custom">Tùy chỉnh</option>
                </select>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Đóng
            </button>
            <button type="button" class="btn btn-primary" id="saveNewColumn">
              Thêm cột
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Remove Table Column Modal -->
    <div
      class="modal fade"
      id="removeColumnModal"
      tabindex="-1"
      aria-labelledby="removeColumnModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="removeColumnModalLabel">Xóa cột</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="removeColumnForm">
              <div class="mb-3">
                <label for="columnToRemove" class="form-label"
                  >Chọn cột cần xóa</label
                >
                <select class="form-select" id="columnToRemove" required>
                  <!-- Columns will be added here -->
                </select>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Đóng
            </button>
            <button
              type="button"
              class="btn btn-danger"
              id="confirmRemoveColumn"
            >
              Xóa cột
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="js/jquery-3.7.1.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/jszip.min.js"></script>
    <script src="js/FileSaver.min.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/builder.js"></script>
  </body>
</html>
